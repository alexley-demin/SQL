# SQL
Соотнесенные подзапросы

1. Напишите команду SELECT, использующую соотнесенный подзапрос, которая

выберет имена и номера всех заказчиков с максимальными для их городов

оценками.

2. Напишите два запроса, отображающие продавцов, которые в своих городах

имеют заказчиков, которых они не обслуживают. Один запрос — с

использованием объединения и один — с соотнесенным подзапросом.

Предикат EXISTS

1. Напишите запрос, который бы использовал оператор EXISTS для извлечения

всех продавцов, которые имеют заказчиков с оценкой 300.

2. Напишите запрос, извлекающий из таблицы Заказчиков каждого заказчика

назначенного к продавцу, который в данный момент имеет, по крайней мере,

еще одного заказчика (кроме заказчика которого вы выберете) с Заказами в

таблице.

Предикаты ANY, SOME, ALL

1. Напишите запрос, который бы выбирал всех заказчиков, чьи оценки равны или

больше чем любая (ANY) оценка заказчиков Serres.

2. Напишите запрос, использующий ANY или ALL, который бы находил всех

продавцов, которые не имеют никаких заказчиков, размещенных в их городе.

3. Напишите запрос, который бы выбирал все Заказы с суммой больше чем с

любая (каждая) для заказчиков из Лондона.

UNION, MINUS, INTERSECT

1. Создайте объединение из двух запросов, которое показало бы имена, города, и

оценки всех заказчиков. Те из них, которые имеют поле rating=200 и более,

должны, кроме того, иметь слова "Высокий Рейтинг", а остальные должны иметь

слова "Низкий Рейтинг" (При указании выбираемых столбцов можно

использовать операцию конкатенации - || ).

2. Напишите команду, которая бы вывела имена и номера каждого продавца и

каждого заказчика, которые имеют больше одного заказа. Результат

представьте в алфавитном порядке.

3. С помощью команды MINUS выведите номера продавцов, у которых нет

заказов.

4. С помощью команды INTERSECT определить существуют ли заказчики с

именами, такими же как у продавцов.

Внешние соединения

1. Для каждого продавца перечислить его покупателей с рейтингом больше 100 в

виде строк формата “snum, sname, cnum, cname”. (В выборке должны быть

перечислены все существующие продавцы).

2. Для каждого покупателя отобразить его продавцов из города Лондон или

Барселона в виде строк формата “cnum, cname, snum, sname ”. (В выборке

должны быть перечислены все существующие покупатели).

3. Перечислить всех продавцов и их покупателей виде строк формата “snum,

sname, cnum, cname”. (В выборке должны быть учтены все существующие

продавцы и покупатели, предусмотреть возможность наличия в таблице Cust

покупателей незакрепленных ни за одним покупателем.).
